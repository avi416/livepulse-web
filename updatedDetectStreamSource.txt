// ×¢×“×›×•×Ÿ ××œ× ×œ×¤×•× ×§×¦×™×™×ª detectStreamSource ×©×™×© ×œ×©×œ×‘ ×‘×§×•×‘×¥ WatchStream.tsx

const detectStreamSource = (videoElement: HTMLVideoElement) => {
  if (!videoElement) return;
  
  console.log('ğŸ” ×‘×•×“×§ ××§×•×¨ ×”×¡×˜×¨×™× ×œ×¤×™ ×¤×¨×•×¤×•×¨×¦×™×•×ª');
  
  // ×”××ª×Ÿ ×¢×“ ×©×™×© ××™×“×¢ ×¢×œ ×’×•×“×œ ×”×•×™×“××•
  const checkVideoSize = () => {
    const { videoWidth, videoHeight } = videoElement;
    
    if (videoWidth && videoHeight) {
      const ratio = videoWidth / videoHeight;
      console.log(`ğŸ“ ×™×—×¡ ×•×™×“××•: ${ratio} (${videoWidth}x${videoHeight})`);
      
      // ×§×‘×™×¢×ª ××§×•×¨ ×”×¡×˜×¨×™× ×œ×¤×™ ×”×™×—×¡ ×”××“×•×™×§ ×©×”×•×’×“×¨
      // ×œ×¨×•×—×‘ - ×™×—×¡ 1.2 ×•××¢×œ×”
      if (ratio >= 1.2) {
        videoElement.setAttribute('data-source', 'landscape');
        console.log('ğŸ–¥ï¸ ×–×™×”×•×™ ××§×•×¨: ×¡×˜×¨×™× ×œ×¨×•×—×‘ (landscape)');
        
        // ×¢×“×›×Ÿ ××ª ×”××™×›×œ
        if (containerRef.current) {
          const container = containerRef.current.querySelector('.tiktok-video-container');
          if (container) {
            container.setAttribute('data-ratio', 'landscape');
          }
        }
      } 
      // ×× ×›×™ - ×™×—×¡ 0.9 ×•××˜×”
      else if (ratio <= 0.9) {
        videoElement.setAttribute('data-source', 'mobile');
        console.log('ğŸ“± ×–×™×”×•×™ ××§×•×¨: ×¡×˜×¨×™× ×œ××•×¨×š (portrait)');
        
        // ×¢×“×›×Ÿ ××ª ×”××™×›×œ
        if (containerRef.current) {
          const container = containerRef.current.querySelector('.tiktok-video-container');
          if (container) {
            container.setAttribute('data-ratio', 'portrait');
          }
        }
      } 
      // ×¨×™×‘×•×¢×™ - ×‘×™×Ÿ 0.9 ×œ-1.2
      else {
        videoElement.setAttribute('data-source', 'square');
        console.log('ğŸ”² ×–×™×”×•×™ ××§×•×¨: ×¡×˜×¨×™× ×¨×™×‘×•×¢×™ (square)');
        
        // ×¢×“×›×Ÿ ××ª ×”××™×›×œ
        if (containerRef.current) {
          const container = containerRef.current.querySelector('.tiktok-video-container');
          if (container) {
            container.setAttribute('data-ratio', 'square');
          }
        }
      }
    }
  };
  
  // ×‘×“×•×§ ××™×“ ×•××—×¨ ×›×š ×‘×¢×ª ×˜×¢×™× ×ª ××˜×-×“××˜×”
  checkVideoSize();
  videoElement.addEventListener('loadedmetadata', checkVideoSize);
};
